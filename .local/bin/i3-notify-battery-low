#!/usr/bin/env bash

set -o errexit
set -o nounset

readonly status_file=/sys/class/power_supply/BAT0/status
readonly capacity_file=/sys/class/power_supply/BAT0/capacity

if [[ "$(cat $status_file)" =~ "Discharging" ]] \
       && [[ "$(cat $capacity_file)" -lt 20 ]]; then
    i3-nagbar -t warning -m "Battery low at $(cat $capacity_file)%!"
fi
