#!/usr/bin/env bash

buf=$( cat "$@" )

if [[ -z "$buf" ]]; then
    echo "no input"
    exit 1
fi

if [[ -z "$(tmux lsb)" || "$buf" != "$(tmux saveb -)" ]]; then
    # Use loadb instead of setb to handle big content
    echo "$buf" | tmux loadb -
fi

if [[ -n "$DISPLAY" ]]; then
    echo -n "$buf" | (pbcopy 2> /dev/null || xsel -ib)
fi
