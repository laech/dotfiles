#!/usr/bin/env bash

buf=$( cat "$@" )

if [[ -z "$buf" ]]; then
    echo "no input"
    exit 1
fi

if [[ -z "$(tmux lsb)" || "$buf" != "$(tmux saveb -)" ]]; then
    tmux setb -- "$buf"
fi

if [[ -n "$DISPLAY" ]]; then
    echo -n "$buf" | (pbcopy 2> /dev/null || xsel -ib)
fi
